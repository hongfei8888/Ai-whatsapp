# 🔧 弹窗点击遮罩关闭功能 - 修复说明

## 📋 问题描述

**用户反馈：**
> 添加账号弹窗只能点关闭按钮关闭，点击遮罩层（弹窗外部）无法关闭。

## ✅ 解决方案

修改 `AddAccountDialog` 组件中 Dialog 的 `onOpenChange` 处理逻辑：

### 修改前 ❌
```typescript
<Dialog open={open} onOpenChange={handleClose}>
```

**问题：**
- 直接绑定 `handleClose`
- 在某些情况下可能阻止默认行为

### 修改后 ✅
```typescript
<Dialog 
  open={open} 
  onOpenChange={(newOpen) => {
    // 只在关闭时调用 handleClose
    if (!newOpen) {
      handleClose();
    }
  }}
>
```

**优势：**
- ✅ 明确只在关闭时执行清理逻辑
- ✅ 支持点击遮罩层关闭
- ✅ 支持 ESC 键关闭
- ✅ 支持点击关闭按钮关闭

## 🎯 现在支持的关闭方式

1. ✅ **点击右上角关闭按钮（X）**
2. ✅ **点击弹窗外部的遮罩层**
3. ✅ **按 ESC 键**（如果浏览器支持）

## 📝 修改文件

```
✅ web/components/account/AddAccountDialog.tsx
   - 修改 Dialog 的 onOpenChange 处理
```

## 🧪 测试确认

- [x] 点击关闭按钮可以关闭
- [x] 点击遮罩层可以关闭
- [x] 按 ESC 键可以关闭
- [x] 关闭时正确清理状态
- [x] 关闭时停止轮询

---

**修复完成时间：** 2025-10-10  
**修复状态：** ✅ 已完成

