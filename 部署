# Vercel éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (Next.js)                         â”‚
â”‚  âœ… éƒ¨ç½²åˆ°ï¼šVercel                      â”‚
â”‚  https://your-app.vercel.app           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ API è¯·æ±‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯ (Fastify + WhatsApp)             â”‚
â”‚  âœ… éƒ¨ç½²åˆ°ï¼šRailway                     â”‚
â”‚  https://your-api.railway.app          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åç«¯åˆ° Railway

### 1. æ³¨å†Œ Railway è´¦å·

è®¿é—®ï¼šhttps://railway.app/
- ä½¿ç”¨ GitHub è´¦å·ç™»å½•

### 2. åˆ›å»ºæ–°é¡¹ç›®

1. ç‚¹å‡» **"New Project"**
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. é€‰æ‹©æ‚¨çš„ä»“åº“ï¼š`hongfei8888/Ai-whatsapp`
4. Railway ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° Dockerfile

### 3. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š

```bash
# å¿…éœ€çš„ç¯å¢ƒå˜é‡
NODE_ENV=production
PORT=4000
HOST=0.0.0.0

# æ•°æ®åº“ URLï¼ˆRailway ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰
DATABASE_URL=postgresql://...

# DeepSeek APIï¼ˆå¦‚æœä½¿ç”¨ AIï¼‰
DEEPSEEK_API_KEY=your_deepseek_api_key

# å…¶ä»–é…ç½®
CORS_ORIGIN=https://your-vercel-app.vercel.app
```

### 4. éƒ¨ç½²è®¾ç½®

Railway ä¼šè‡ªåŠ¨ï¼š
- âœ… æ„å»º Docker é•œåƒ
- âœ… è¿è¡Œå®¹å™¨
- âœ… åˆ†é…å…¬å…± URL

å®Œæˆåï¼Œè®°ä¸‹æ‚¨çš„åç«¯ URLï¼Œä¾‹å¦‚ï¼š
```
https://ai-whatsapp-production.up.railway.app
```

---

## ğŸ¨ ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ° Vercel

### æ–¹å¼ 1ï¼šé€šè¿‡ Vercel Dashboardï¼ˆæ¨èï¼‰

#### 1. å‡†å¤‡é¡¹ç›®

åœ¨æœ¬åœ°æ‰§è¡Œï¼š

```bash
# 1. å¤åˆ¶ Vercel é…ç½®
cd web
cp next.config.vercel.js next.config.js

# 2. æäº¤æ›´æ”¹
git add next.config.js vercel.json
git commit -m "Add Vercel deployment config"
git push origin master
```

#### 2. å¯¼å…¥åˆ° Vercel

1. è®¿é—®ï¼šhttps://vercel.com/new
2. ä½¿ç”¨ GitHub ç™»å½•
3. å¯¼å…¥ä»“åº“ï¼š`hongfei8888/Ai-whatsapp`
4. é…ç½®é¡¹ç›®ï¼š
   - **Framework Preset**: Next.js
   - **Root Directory**: `web`ï¼ˆé‡è¦ï¼ï¼‰
   - **Build Command**: `npm run build`
   - **Output Directory**: `.next`

#### 3. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š

```bash
# åç«¯ API åœ°å€ï¼ˆå¡«å†™ Railway æä¾›çš„ URLï¼‰
NEXT_PUBLIC_API_BASE_URL=https://your-api.railway.app

# WebSocket åœ°å€ï¼ˆä¸ API ç›¸åŒï¼Œä½†ä½¿ç”¨ wss://ï¼‰
NEXT_PUBLIC_WS_URL=wss://your-api.railway.app

# åº”ç”¨åç§°ï¼ˆå¯é€‰ï¼‰
NEXT_PUBLIC_APP_NAME=WhatsApp AI Automation
```

#### 4. éƒ¨ç½²

ç‚¹å‡» **"Deploy"**ï¼ŒVercel ä¼šï¼š
- âœ… å®‰è£…ä¾èµ–
- âœ… æ„å»º Next.js åº”ç”¨
- âœ… è‡ªåŠ¨éƒ¨ç½²

å®Œæˆåï¼Œæ‚¨ä¼šå¾—åˆ°ä¸€ä¸ª URLï¼š
```
https://your-app.vercel.app
```

---

### æ–¹å¼ 2ï¼šé€šè¿‡ Vercel CLI

```bash
# 1. å®‰è£… Vercel CLI
npm install -g vercel

# 2. è¿›å…¥å‰ç«¯ç›®å½•
cd web

# 3. ç™»å½• Vercel
vercel login

# 4. éƒ¨ç½²
vercel --prod

# 5. æŒ‰ç…§æç¤ºé…ç½®é¡¹ç›®
```

---

## ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šé…ç½® CORS

### æ›´æ–°åç«¯ CORS è®¾ç½®

åœ¨ Railway ç¯å¢ƒå˜é‡ä¸­æ·»åŠ ï¼š

```bash
CORS_ORIGIN=https://your-vercel-app.vercel.app
```

æˆ–è€…åœ¨ä»£ç ä¸­é…ç½®ï¼ˆ`server/src/server.ts`ï¼‰ï¼š

```typescript
fastify.register(cors, {
  origin: [
    'https://your-vercel-app.vercel.app',
    'http://localhost:3000', // å¼€å‘ç¯å¢ƒ
  ],
  credentials: true,
});
```

---

## âœ… ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 1. æµ‹è¯•å‰ç«¯

è®¿é—®ï¼š`https://your-vercel-app.vercel.app/dashboard`

åº”è¯¥èƒ½çœ‹åˆ°ï¼š
- âœ… Dashboard é¡µé¢æ­£å¸¸åŠ è½½
- âœ… å·¦ä¾§å¯¼èˆªèœå•æ˜¾ç¤º
- âœ… ç»Ÿè®¡æ•°æ®æ˜¾ç¤º

### 2. æµ‹è¯•åç«¯è¿æ¥

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æŸ¥çœ‹ï¼š
- âœ… API è¯·æ±‚æˆåŠŸ
- âœ… WebSocket è¿æ¥æˆåŠŸ
- âŒ å¦‚æœæœ‰è·¨åŸŸé”™è¯¯ï¼Œæ£€æŸ¥ CORS é…ç½®

### 3. æµ‹è¯• WhatsApp åŠŸèƒ½

1. ç‚¹å‡» **"æ·»åŠ è´¦å·"**
2. åº”è¯¥æ˜¾ç¤ºäºŒç»´ç 
3. ä½¿ç”¨æ‰‹æœºæ‰«ç ç™»å½•

---

## ğŸŒ åŸŸåé…ç½®ï¼ˆå¯é€‰ï¼‰

### Vercel è‡ªå®šä¹‰åŸŸå

1. è¿›å…¥ Vercel é¡¹ç›®è®¾ç½®
2. **Domains** â†’ **Add Domain**
3. è¾“å…¥æ‚¨çš„åŸŸåï¼ˆå¦‚ `app.yourdomain.com`ï¼‰
4. æŒ‰ç…§æç¤ºé…ç½® DNSï¼š
   ```
   ç±»å‹: CNAME
   åç§°: app
   å€¼: cname.vercel-dns.com
   ```

### Railway è‡ªå®šä¹‰åŸŸå

1. è¿›å…¥ Railway é¡¹ç›®è®¾ç½®
2. **Settings** â†’ **Domains**
3. æ·»åŠ è‡ªå®šä¹‰åŸŸå
4. é…ç½® DNSï¼š
   ```
   ç±»å‹: CNAME
   åç§°: api
   å€¼: your-project.railway.app
   ```

---

## ğŸ“Š éƒ¨ç½²åçš„é¡¹ç›®ç»“æ„

```
ç”Ÿäº§ç¯å¢ƒï¼š
â”œâ”€â”€ å‰ç«¯: https://your-app.vercel.app
â”‚   â”œâ”€â”€ /dashboard/          # æ§åˆ¶é¢æ¿
â”‚   â”œâ”€â”€ /contacts/           # è”ç³»äººç®¡ç†
â”‚   â”œâ”€â”€ /campaigns/          # è¥é”€æ´»åŠ¨
â”‚   â””â”€â”€ /settings/           # è®¾ç½®
â”‚
â””â”€â”€ åç«¯: https://your-api.railway.app
    â”œâ”€â”€ /status              # ç³»ç»ŸçŠ¶æ€
    â”œâ”€â”€ /auth/*              # è®¤è¯ç›¸å…³
    â”œâ”€â”€ /contacts/*          # è”ç³»äºº API
    â”œâ”€â”€ /campaigns/*         # è¥é”€ API
    â””â”€â”€ /ws                  # WebSocket
```

---

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šå‰ç«¯æ— æ³•è¿æ¥åç«¯

**ç—‡çŠ¶**ï¼šDashboard æ˜¾ç¤º "è¿æ¥å¤±è´¥"

**è§£å†³**ï¼š
1. æ£€æŸ¥ Vercel ç¯å¢ƒå˜é‡ `NEXT_PUBLIC_API_BASE_URL` æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ Railway åç«¯æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 2ï¼šCORS é”™è¯¯

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºè·¨åŸŸé”™è¯¯

**è§£å†³**ï¼š
1. åœ¨ Railway æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   ```
   CORS_ORIGIN=https://your-vercel-app.vercel.app
   ```
2. é‡å¯ Railway æœåŠ¡

### é—®é¢˜ 3ï¼šWebSocket è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼šå®æ—¶æ›´æ–°ä¸å·¥ä½œ

**è§£å†³**ï¼š
1. æ£€æŸ¥ `NEXT_PUBLIC_WS_URL` ä½¿ç”¨ `wss://`ï¼ˆä¸æ˜¯ `ws://`ï¼‰
2. ç¡®ä¿ Railway æ”¯æŒ WebSocketï¼ˆé»˜è®¤æ”¯æŒï¼‰

### é—®é¢˜ 4ï¼šæ„å»ºå¤±è´¥

**ç—‡çŠ¶**ï¼šVercel æ„å»ºæŠ¥é”™

**è§£å†³**ï¼š
1. ç¡®è®¤ **Root Directory** è®¾ç½®ä¸º `web`
2. æ£€æŸ¥ `package.json` ä¸­çš„ä¾èµ–ç‰ˆæœ¬
3. æŸ¥çœ‹ Vercel æ„å»ºæ—¥å¿—

---

## ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### Vercel é…ç½®

1. **å¯ç”¨ Edge Caching**
   ```javascript
   // åœ¨é¡µé¢ä¸­æ·»åŠ 
   export const revalidate = 60; // 60 ç§’é‡æ–°éªŒè¯
   ```

2. **å›¾ç‰‡ä¼˜åŒ–**
   ```javascript
   // ä½¿ç”¨ Next.js Image ç»„ä»¶
   import Image from 'next/image';
   ```

3. **ä»£ç åˆ†å‰²**
   - Next.js è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€é…ç½®

### Railway é…ç½®

1. **å¢åŠ å®ä¾‹æ•°é‡**ï¼ˆå¦‚æœæµé‡å¤§ï¼‰
   - åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­è°ƒæ•´

2. **å¯ç”¨å¥åº·æ£€æŸ¥**
   ```dockerfile
   HEALTHCHECK --interval=30s --timeout=10s \
     CMD curl -f http://localhost:4000/status || exit 1
   ```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### Vercelï¼ˆå‰ç«¯ï¼‰

- **Hobby è®¡åˆ’**ï¼šå…è´¹
  - 100 GB å¸¦å®½/æœˆ
  - æ— é™éƒ¨ç½²
  - è‡ªåŠ¨ HTTPS
  - å…¨çƒ CDN

- **Pro è®¡åˆ’**ï¼š$20/æœˆ
  - 1 TB å¸¦å®½
  - æ›´å¿«æ„å»ºæ—¶é—´
  - å›¢é˜Ÿåä½œ

### Railwayï¼ˆåç«¯ï¼‰

- **Developer è®¡åˆ’**ï¼š$5/æœˆèµ·
  - 500 å°æ—¶è¿è¡Œæ—¶é—´
  - 8 GB RAM
  - 100 GB ç£ç›˜

- **Team è®¡åˆ’**ï¼š$20/æœˆèµ·
  - æ›´å¤šèµ„æº
  - å›¢é˜ŸåŠŸèƒ½

**é¢„ä¼°æ€»æˆæœ¬**ï¼š$5-25/æœˆï¼ˆå–å†³äºæµé‡ï¼‰

---

## ğŸ“š ç›¸å…³èµ„æº

- [Vercel æ–‡æ¡£](https://vercel.com/docs)
- [Railway æ–‡æ¡£](https://docs.railway.app)
- [Next.js éƒ¨ç½²æŒ‡å—](https://nextjs.org/docs/deployment)
- [é¡¹ç›® GitHub](https://github.com/hongfei8888/Ai-whatsapp)

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨æ‚¨çš„ WhatsApp AI è‡ªåŠ¨åŒ–ç³»ç»Ÿå·²ç»éƒ¨ç½²åˆ°äº‘ç«¯ï¼

- âœ… å‰ç«¯ï¼šé«˜æ€§èƒ½å…¨çƒ CDN
- âœ… åç«¯ï¼šç¨³å®šçš„å®¹å™¨åŒ–éƒ¨ç½²
- âœ… è‡ªåŠ¨ HTTPS
- âœ… é›¶åœæœºéƒ¨ç½²
- âœ… å…¨çƒè®¿é—®

**äº«å—æ‚¨çš„äº‘ç«¯åº”ç”¨å§ï¼** ğŸš€

